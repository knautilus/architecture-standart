### <a name="_b7urdng99y53"></a>**Название задачи: Открытие депозитов онлайн**

### <a name="_hjk0fkfyohdk"></a>**Автор: Утянский А.Ю.**

### <a name="_uanumrh8zrui"></a>**Дата: 31.07.2025**

### <a name="_3bfxc9a45514"></a>**Функциональные требования**

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
| UC1 | Клиент, Сайт, Интернет-банк | Просмотр доступных депозитов | На сайте и в интернет-банке клиент видит список доступных депозитов с актуальными ставками |
| UC2 | Клиент, Интернет-банк | Просмотр персонализированных ставок | В интернет-банке клиент видит персонализированные ставки, составленные на основе его кредитной истории |
| UC3 | Клиент, Интернет-банк | Подача заявки на депозит в интернет-банке | Клиент подает заявку на депозит, указав счёт и сумму депозита. Пользователю отправляется СМС-код для подтверждения операции. Заявка появляется в системе АБС |
| UC4 | Клиент, Сайт | Подача заявки на депозит на сайте | Клиент подает заявку на депозит, указав в веб-форме свой номер телефона и Ф.И.О., после чего заявка должна попасть в систему кол-центра |
| UC5 | Кол-центр | Обработка заявок в кол-центре | Менеджер кол-центра звонит клиенту. Изучив заявку в системе кол-центра, менеджер может предложить особые условия. Менеджер приглашает клиента прийти в отделение для идентификации. Заявка передается в АБС |
| UC6 | Бэк-офис | Обработка заявок в бэк-офисе | Менеджер в бэк-офисе обрабатывает заявку на открытие депозита. Он подтверждает условия депозита в АБС банка. Клиент получает СМС-уведомление об открытии депозита |
| UC7 | Клиент, Интернет-банк | Просмотр своих депозитов | В интернет-банке клиент просматривает список своих депозитов, а также детализацию по отдельным депозитам |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

|**№**|**Требование**|
| :-: | :- |
| 1 | Доступность: 99.9%, поддержка переключения на резервный ЦОД |
| 2 | Масштабирование: горизонтальное для серверов и ЦОД, вертикальное - для АБС |
| 3 | Шифрование трафика между клиентом и сервером |
| 4 | Время отклика по всем операциям не более 300 мс |
| 5 | Поддержка существующих в компании технологий (например, MS SQL, Oracle). По новым технологиям должна быть экспертиза внутри банка |
| 6 | Разработка документации для дальнейшего расширения системы |
| 7 | Новые фичи в интернет-банке не должны требовать доработки ядра системы |
| 8 | Избежать прямой работы интернет-банка с API АБС |
| 9 | Оптимизация загрузки справочных данных с помощью кэширования |

### <a name="_qmphm5d6rvi3"></a>**Решение**

[Визуализация контекста](C4_Context.puml)

[Визуализация контейнеров](C4_Container.puml)

- Поскольку новые фичи в интернет-банке не должны требовать доработки ядра системы, новый функционал бэкенда по открытию депозитов был вынесен в отдельный микросервис. Микросервис более масштабируем и прост в развертывании по сравнению с монолитом интернет-банка. Данный микросервис будет использоваться как фронтендом сайта, так и монолитом интернет-банка.
- Т.к. база данных АБС уже перегружена, то заявки, поступающие через кол-центр, сайт и интернет-банк, будут записываться в отдельную базу данных на PostgreSQL. Сервис репликации раз в 10 минут собирает свежие заявки из новой БД и сохраняет их за один запрос в БД АБС.
- Для повышения скорости работы сайта и интернет банкинга было решено использовать кэш на Redis, чтобы избежать частых и излишних обращений к базе данных.
- Управление ставками переносится из Excel в АБС для повышения скорости коммуникации и унификации процессов.
- Было принято решение создать отдельный сервис нотификаций, т.к. это позволит в будущем легко добавлять новые каналы уведомлений и расширять функциональность. Сервис нотификаций асинхронно принимает сообщения от АБС и микросервиса заявок посредством Kafka.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**

- Для хранения данных в новом микросервисе можно было бы использовать СУБД на Oracle или MS SQL, т.к. они уже используются в других системах компании. Но была выбрана СУБД PostgreSQL, т.к. она бесплатная и с открытым кодом.
- Для кэширования данных можно использовать memcache, однако он не поддерживает персистентность (сохранение данных при перезагрузке).

**Недостатки, ограничения, риски**

Подробно опишите здесь недостатки, ограничения и риски выбранного решения.

