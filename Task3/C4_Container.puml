@startuml

title Диаграмма контейнеров банка "Стандарт"

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(Client, "Клиент банка")
Person(FOManager, "Менеджер Фронт-офиса")
Person(BODepositManager, "Менеджер Бэк-офиса по депозитам")
Person(BOCreditManager, "Менеджер Бэк-офиса по кредитам")
Person(CallOperator, "Оператор кол-центра")

Container_Boundary(Bank, "Банк Стандарт") {
    Container(Site, "Сайт")
    Container(InternetBank, "Интернет банк")
    Container(FECallCenter, "Frontend кол-центра")
    Container(FEAbs, "Frontend АБС")
    Container(ApiGateway, "Api Gateway", "Шлюз для направления запросов на соответствующие сервисы")
    Container(BESite, "Backend сайта")
    Container(BEInternetBank, "Backend интернет банка")
    Container(BECallCenter, "Backend кол-центра")
    Container(BEAbs, "Backend АБС")
    Container(NotificationService, "Сервис нотификаций")
    Container(SMSGateway, "CМС Шлюз")
    ContainerDb(DBInfo, "БД справочной информации", "PostgreSQL")
    ContainerDb(CacheInfo, "Кэш справочной информации", "Redis")
    ContainerDb(DBAbs, "БД АБС", "Oracle")
    Container(ReplicationService, "Сервис репликации данных")
    ContainerDb(DBClient, "БД клиентов, заявок, депозитов", "PostgreSQL")
    ContainerQueue(Queue, "Брокер сообщений", "Обмен данными между сервисами")
}

System_Ext(Telecom, "Телеком-оператор")

Rel(Client, FOManager, "Подает заявку")
Rel(Client, Site, "Смотрит информацию о банке и доступные депозиты")
Rel(Client, InternetBank, "Смотрит информацию о банке, доступные депозиты, подает заявку")
Rel(CallOperator, FECallCenter, "Обрабатывает заявку")
Rel(CallOperator, Client, "Предлагает особые условия, приглашает прийти в отделение для идентификации")
Rel(FOManager, FEAbs, "Запрашивает ставку, размещает маркетинговую информацию, создает депозит, загружает документы")
Rel(BODepositManager, FEAbs, "Обрабатывает заявки, определяет ставку")
Rel(BOCreditManager, FEAbs, "Анализирует уровень кредитного риска относительно клиентов")
Rel(Site, ApiGateway, "Отправляет запросы")
Rel(InternetBank, ApiGateway, "Отправляет запросы")
Rel(FECallCenter, ApiGateway, "Отправляет запросы")
Rel(FEAbs, ApiGateway, "Отправляет запросы")
Rel(ApiGateway, BESite, "Отправляет запросы")
Rel(ApiGateway, BEInternetBank, "Отправляет запросы")
Rel(ApiGateway, BECallCenter, "Отправляет запросы")
Rel(ApiGateway, BEAbs, "Отправляет запросы")
Rel(BESite, CacheInfo, "Работает с кэшем")
Rel(BEInternetBank, CacheInfo, "Работает с кэшем")
Rel(BESite, DBInfo, "Читает данные")
Rel(BEInternetBank, DBInfo, "Читает данные")
Rel(BESite, DBClient, "Записывает данные")
Rel(BECallCenter, DBClient, "Читает, записывает данные")
Rel(BEInternetBank, DBClient, "Читает, записывает данные")
Rel(BEAbs, DBAbs, "Читает, записывает данные")
Rel(BEAbs, Queue, "Публикует уведомления")
Rel(NotificationService, Queue, "Получает уведомления")
Rel(ReplicationService, DBAbs, "Реплицирует данные")
Rel(ReplicationService, DBClient, "Реплицирует данные")
Rel(NotificationService, SMSGateway, "Отправляет СМС с решением по депозиту")
Rel(SMSGateway, Telecom, "Отправляет СМС")
Rel(Telecom, Client, "Отправляет СМС")

@enduml